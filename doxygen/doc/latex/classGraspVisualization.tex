\section{Grasp\+Visualization Class Reference}
\label{classGraspVisualization}\index{Grasp\+Visualization@{Grasp\+Visualization}}


This class shows the computed grasping pose and trajectory overlapped to the camera images.  




{\ttfamily \#include $<$grasp\+Visualization.\+h$>$}



Inherits Rate\+Thread.

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bfseries Grasp\+Visualization} (int rate, const std\+::string \&\+\_\+eye, yarp\+::dev\+::\+I\+Gaze\+Control $\ast$\+\_\+igaze, bool \&executed, const yarp\+::sig\+::\+Matrix \+\_\+K, std\+::string \hyperlink{classGraspVisualization_ac960abe59ca5c92521d9cb9f01dc6370}{left\+\_\+or\+\_\+right}, const yarp\+::os\+::\+Property \&\hyperlink{classGraspVisualization_a542f3bc536b354d12256f2c95fcadab1}{complete\+\_\+sol}, const yarp\+::sig\+::\+Vector \&\+\_\+object, yarp\+::sig\+::\+Vector \&\hyperlink{classGraspVisualization_af6ecf326ddb626e2dd7f83e8d75d12eb}{hand}, yarp\+::sig\+::\+Vector \&\hyperlink{classGraspVisualization_a23c0f2f9e30b20ff6ec38e0fe119ab39}{hand1}, yarp\+::os\+::\+Property \&\hyperlink{classGraspVisualization_a0efcb3e2545e09b7480da109ceaa4533}{vis\+\_\+par}, double \&quality\+\_\+right, double \&quality\+\_\+left)\label{classGraspVisualization_a33db96015b6d831cbd12d3c2279ec161}

\item 
void \hyperlink{classGraspVisualization_a0069fc0b6752a254d09d5f5f7f72dba8}{add\+Superq} (const yarp\+::sig\+::\+Vector \&x, yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ \&img\+Out, const int \&col)
\begin{DoxyCompactList}\small\item\em Overlap superquadric on the camera image. \end{DoxyCompactList}\item 
yarp\+::sig\+::\+Vector \hyperlink{classGraspVisualization_a7217275a38ec798541bd68a84618bda6}{from3\+Dto2D} (const yarp\+::sig\+::\+Vector \&point3D)
\begin{DoxyCompactList}\small\item\em Convert 3D point to 3D point. \end{DoxyCompactList}\item 
bool \hyperlink{classGraspVisualization_a3ada3605a942fb51696e9747fed52a72}{show\+Trajectory} (const std\+::string \&\hyperlink{classGraspVisualization_af6ecf326ddb626e2dd7f83e8d75d12eb}{hand})
\begin{DoxyCompactList}\small\item\em Show the computed trajectory. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classGraspVisualization_a277232b1b99ecc061242abee8175ff16}{thread\+Init} ()\label{classGraspVisualization_a277232b1b99ecc061242abee8175ff16}

\begin{DoxyCompactList}\small\item\em Init function of the thread. \end{DoxyCompactList}\item 
virtual void \hyperlink{classGraspVisualization_a1498b5c983abd973e9482f2da97aa5c2}{run} ()\label{classGraspVisualization_a1498b5c983abd973e9482f2da97aa5c2}

\begin{DoxyCompactList}\small\item\em Run function of the thread. \end{DoxyCompactList}\item 
virtual void \hyperlink{classGraspVisualization_a1c25a50d14603a5cda42626afb4aaa47}{thread\+Release} ()\label{classGraspVisualization_a1c25a50d14603a5cda42626afb4aaa47}

\begin{DoxyCompactList}\small\item\em release function of the thread \end{DoxyCompactList}\item 
double \hyperlink{classGraspVisualization_ac9d26a90c1f1b6121ebbb0521053a80f}{get\+Time} ()
\begin{DoxyCompactList}\small\item\em Get time required for showing the superquadrics and poses. \end{DoxyCompactList}\item 
void \hyperlink{classGraspVisualization_a11fdc62f11352941ce39bf0444060290}{get\+Poses} (const yarp\+::os\+::\+Property \&poses)
\begin{DoxyCompactList}\small\item\em Acquire poses from other threads. \end{DoxyCompactList}\item 
void \hyperlink{classGraspVisualization_a68062fbac492b9277576f4ee871bdb41}{set\+Par} (const yarp\+::os\+::\+Property \&new\+Options, bool first\+\_\+time)
\begin{DoxyCompactList}\small\item\em Set parameters for visualization. \end{DoxyCompactList}\item 
yarp\+::os\+::\+Property \hyperlink{classGraspVisualization_a9071090277d53e90c6392b7e879e0247}{get\+Par} ()
\begin{DoxyCompactList}\small\item\em Set parameters used for visualization. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
yarp\+::dev\+::\+I\+Gaze\+Control $\ast$ {\bfseries igaze}\label{classGraspVisualization_a21aac46017bc0d4b77d37657715961c0}

\item 
double \hyperlink{classGraspVisualization_a99b826fdf481e24b0257eea6c1942f8d}{t\+\_\+vis}\label{classGraspVisualization_a99b826fdf481e24b0257eea6c1942f8d}

\begin{DoxyCompactList}\small\item\em Visualization time. \end{DoxyCompactList}\item 
bool \hyperlink{classGraspVisualization_a973a23fe3e4429f3d8c420d27b5ce77f}{show\+\_\+hand}\label{classGraspVisualization_a973a23fe3e4429f3d8c420d27b5ce77f}

\begin{DoxyCompactList}\small\item\em Boolean variable for set if to show hand or not. \end{DoxyCompactList}\item 
bool \hyperlink{classGraspVisualization_a166196c3b0420564d434a93987223951}{look\+\_\+object}\label{classGraspVisualization_a166196c3b0420564d434a93987223951}

\begin{DoxyCompactList}\small\item\em Boolean variable for set if to look object or not. \end{DoxyCompactList}\item 
bool \hyperlink{classGraspVisualization_a12af63a6de8420f32b727aa934c68c8c}{show\+\_\+only\+\_\+pose}\label{classGraspVisualization_a12af63a6de8420f32b727aa934c68c8c}

\begin{DoxyCompactList}\small\item\em Boolean variable for set if to show trajectory or not. \end{DoxyCompactList}\item 
std\+::string \hyperlink{classGraspVisualization_ac960abe59ca5c92521d9cb9f01dc6370}{left\+\_\+or\+\_\+right}\label{classGraspVisualization_ac960abe59ca5c92521d9cb9f01dc6370}

\begin{DoxyCompactList}\small\item\em Which hand is involved. \end{DoxyCompactList}\item 
yarp\+::os\+::\+Mutex {\bfseries mutex}\label{classGraspVisualization_a2fd6a0f8c21ddf8097efe413cfd16bea}

\item 
const yarp\+::sig\+::\+Vector \& \hyperlink{classGraspVisualization_a2d3a7e82db39172cf777189f4b006dbf}{object}\label{classGraspVisualization_a2d3a7e82db39172cf777189f4b006dbf}

\begin{DoxyCompactList}\small\item\em Object superquadric. \end{DoxyCompactList}\item 
yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ $\ast$ \hyperlink{classGraspVisualization_a67af368e12d13ef91e99e01a92e60850}{img\+In}\label{classGraspVisualization_a67af368e12d13ef91e99e01a92e60850}

\begin{DoxyCompactList}\small\item\em Input image. \end{DoxyCompactList}\item 
yarp\+::os\+::\+Property \hyperlink{classGraspVisualization_a0efcb3e2545e09b7480da109ceaa4533}{vis\+\_\+par}\label{classGraspVisualization_a0efcb3e2545e09b7480da109ceaa4533}

\begin{DoxyCompactList}\small\item\em Visualization parameters. \end{DoxyCompactList}\item 
yarp\+::sig\+::\+Vector \& \hyperlink{classGraspVisualization_af6ecf326ddb626e2dd7f83e8d75d12eb}{hand}\label{classGraspVisualization_af6ecf326ddb626e2dd7f83e8d75d12eb}

\begin{DoxyCompactList}\small\item\em One hand ellipsoid. \end{DoxyCompactList}\item 
yarp\+::sig\+::\+Vector \& \hyperlink{classGraspVisualization_a23c0f2f9e30b20ff6ec38e0fe119ab39}{hand1}\label{classGraspVisualization_a23c0f2f9e30b20ff6ec38e0fe119ab39}

\begin{DoxyCompactList}\small\item\em One hand ellipsoid. \end{DoxyCompactList}\item 
const yarp\+::os\+::\+Property \& \hyperlink{classGraspVisualization_a542f3bc536b354d12256f2c95fcadab1}{complete\+\_\+sol}\label{classGraspVisualization_a542f3bc536b354d12256f2c95fcadab1}

\begin{DoxyCompactList}\small\item\em Complete solution. \end{DoxyCompactList}\item 
bool \& {\bfseries executed}\label{classGraspVisualization_ac1c748f2c0bbb38c4ea19216cb4dbfc8}

\item 
bool {\bfseries stop\+\_\+fixate}\label{classGraspVisualization_ad26b15866f86df9e9c2ec59658cfdd80}

\item 
yarp\+::os\+::\+Buffered\+Port$<$ yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ $>$ \hyperlink{classGraspVisualization_a82ecdc743d9883336682ffd0e6b9c113}{port\+Img\+In}\label{classGraspVisualization_a82ecdc743d9883336682ffd0e6b9c113}

\begin{DoxyCompactList}\small\item\em Buffered port of input image. \end{DoxyCompactList}\item 
yarp\+::os\+::\+Buffered\+Port$<$ yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ $>$ \hyperlink{classGraspVisualization_a9d9aab016248eb6eec902fed80e74d65}{port\+Img\+Out}\label{classGraspVisualization_a9d9aab016248eb6eec902fed80e74d65}

\begin{DoxyCompactList}\small\item\em Buffered port of output image. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::string {\bfseries eye}\label{classGraspVisualization_ace61511b9d00f72c39311e6213dc4047}

\item 
yarp\+::dev\+::\+Poly\+Driver {\bfseries Gaze\+Ctrl}\label{classGraspVisualization_ad7bdd9a15a2c683a358e77bb694598d2}

\item 
yarp\+::sig\+::\+Matrix {\bfseries K}\label{classGraspVisualization_a36a4e8dd697faf597dcb41d95aac83de}

\item 
yarp\+::sig\+::\+Matrix {\bfseries H}\label{classGraspVisualization_a422df68dee6c62ba04f00677dccae57e}

\item 
yarp\+::sig\+::\+Vector {\bfseries poseR}\label{classGraspVisualization_ab78d3c9bb633b704b22244db49b08423}

\item 
yarp\+::sig\+::\+Vector {\bfseries poseL}\label{classGraspVisualization_afe153394fdf1ffd1b70a3396d469188d}

\item 
yarp\+::sig\+::\+Vector {\bfseries solR}\label{classGraspVisualization_a2f2c72e622512ee74014e3715beba78b}

\item 
yarp\+::sig\+::\+Vector {\bfseries solL}\label{classGraspVisualization_a4952ee1be9e70461326b47ef50f064f2}

\item 
yarp\+::sig\+::\+Vector {\bfseries hand\+\_\+in\+\_\+poseL}\label{classGraspVisualization_a25591f12c24270bc2257eb2a5446e85d}

\item 
yarp\+::sig\+::\+Vector {\bfseries hand\+\_\+in\+\_\+poseR}\label{classGraspVisualization_ae4f26a3c1c3c4b51ac043bdfb1176092}

\item 
std\+::deque$<$ yarp\+::sig\+::\+Vector $>$ {\bfseries trajectory\+\_\+right}\label{classGraspVisualization_af2ad3c4bb204694b6948fa99d508282f}

\item 
std\+::deque$<$ yarp\+::sig\+::\+Vector $>$ {\bfseries trajectory\+\_\+left}\label{classGraspVisualization_a8d400d538af6c649485081f306d43e3e}

\item 
yarp\+::sig\+::\+Vector {\bfseries point2D}\label{classGraspVisualization_ad377be64896271582eb9f5257ecef819}

\item 
yarp\+::sig\+::\+Vector {\bfseries point}\label{classGraspVisualization_ae8cf3097e9a8542ba3562fdfc8837995}

\item 
yarp\+::sig\+::\+Vector {\bfseries point1}\label{classGraspVisualization_a0a87a52dda56b81b1b6f7d36c969672c}

\item 
yarp\+::sig\+::\+Vector {\bfseries superq}\label{classGraspVisualization_a38fa19f89c4185545bc35be510ad6158}

\item 
std\+::deque$<$ yarp\+::sig\+::\+Vector $>$ {\bfseries trajectory}\label{classGraspVisualization_a7a9b020ba00e06ffc1d272214697a6b7}

\item 
yarp\+::sig\+::\+Matrix {\bfseries R}\label{classGraspVisualization_a0171ee2be1eb60dde9f889313b247658}

\item 
double \& {\bfseries quality\+\_\+right}\label{classGraspVisualization_aa82104f77a9903438727132275401f96}

\item 
double \& {\bfseries quality\+\_\+left}\label{classGraspVisualization_aabfdc93263c2684e1fecf110e733c090}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class shows the computed grasping pose and trajectory overlapped to the camera images. 

Definition at line 36 of file grasp\+Visualization.\+h.



\subsection{Member Function Documentation}
\index{Grasp\+Visualization@{Grasp\+Visualization}!add\+Superq@{add\+Superq}}
\index{add\+Superq@{add\+Superq}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{add\+Superq(const yarp\+::sig\+::\+Vector \&x, yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ \&img\+Out, const int \&col)}{addSuperq(const yarp::sig::Vector &x, yarp::sig::ImageOf< yarp::sig::PixelRgb > &imgOut, const int &col)}}]{\setlength{\rightskip}{0pt plus 5cm}void Grasp\+Visualization\+::add\+Superq (
\begin{DoxyParamCaption}
\item[{const yarp\+::sig\+::\+Vector \&}]{x, }
\item[{yarp\+::sig\+::\+Image\+Of$<$ yarp\+::sig\+::\+Pixel\+Rgb $>$ \&}]{img\+Out, }
\item[{const int \&}]{col}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a0069fc0b6752a254d09d5f5f7f72dba8}


Overlap superquadric on the camera image. 


\begin{DoxyParams}{Parameters}
{\em x} & is the superquadric to be visualization \\
\hline
{\em img\+Out} & is the image on which to overlpa the superquadroc \\
\hline
{\em col} & is the color to be used for drawing \\
\hline
\end{DoxyParams}


Definition at line 261 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
262 \{
263     \textcolor{keywordtype}{int} count=0;
264 
265     PixelRgb color(col,0,0);
266 
267     \textcolor{keywordflow}{if} (col==0)
268     \{
269         color.r=0;
270         color.b=255;
271     \}
272 
273     Vector pos, orient;
274     \textcolor{keywordtype}{double} co,so,ce,se;
275     Stamp *stamp=NULL;
276 
277     Matrix R=euler2dcm(x.subVector(8,10));
278     R=R.transposed();
279 
280     \textcolor{keywordflow}{if} ((norm(x)>0.0))
281     \{
282         \textcolor{keywordflow}{if} (eye==\textcolor{stringliteral}{"left"})
283         \{
284             \textcolor{keywordflow}{if} (igaze->getLeftEyePose(pos,orient,stamp))
285             \{
286                 H=axis2dcm(orient);
287                 H.setSubcol(pos,0,3);
288                 H=SE3inv(H);
289             \}
290         \}
291         \textcolor{keywordflow}{else}
292         \{
293             \textcolor{keywordflow}{if} (igaze->getRightEyePose(pos,orient,stamp))
294             \{
295                 H=axis2dcm(orient);
296                 H.setSubcol(pos,0,3);
297                 H=SE3inv(H);
298             \}
299         \}
300 
301         Vector point(3,0.0);
302         Vector point2D(2,0.0);
303         \textcolor{keywordtype}{double} step=2*M\_PI/50;
304 
305         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{double} eta=-M\_PI; eta<M\_PI; eta+=step)
306         \{
307              \textcolor{keywordflow}{for} (\textcolor{keywordtype}{double} omega=-M\_PI; omega<M\_PI;omega+=step)
308              \{
309                  co=cos(omega); so=sin(omega);
310                  ce=cos(eta); se=sin(eta);
311 
312                  point[0]=x[0] * sign(ce)*(pow(abs(ce),x[3])) * sign(co)*(pow(abs(co),x[4])) * R(0,0) +
313                             x[1] * sign(ce)*(pow(abs(ce),x[3]))* sign(so)*(pow(abs(so),x[4])) * R(0,1)+
314                                 x[2] * sign(se)*(pow(abs(se),x[3])) * R(0,2) + x[5];
315 
316                  point[1]=x[0] * sign(ce)*(pow(abs(ce),x[3])) * sign(co)*(pow(abs(co),x[4])) * R(1,0) +
317                             x[1] * sign(ce)*(pow(abs(ce),x[3])) * sign(so)*(pow(abs(so),x[4])) * R(1,1)+
318                                 x[2] * sign(se)*(pow(abs(se),x[3])) * R(1,2) + x[6];
319 
320                  point[2]=x[0] * sign(ce)*(pow(abs(ce),x[3])) * sign(co)*(pow(abs(co),x[4])) * R(2,0) +
321                             x[1] * sign(ce)*(pow(abs(ce),x[3])) * sign(so)*(pow(abs(so),x[4])) * R(2,1)+
322                                 x[2] * sign(se)*(pow(abs(se),x[3])) * R(2,2) + x[7];
323 
324                  point2D=from3Dto2D(point);
325 
326                  cv::Point target\_point((\textcolor{keywordtype}{int})point2D[0],(\textcolor{keywordtype}{int})point2D[1]);
327 
328                  \textcolor{keywordflow}{if} ((target\_point.x<0) || (target\_point.y<0) || (target\_point.x>=320) || (target\_point.y>=
      240))
329                  \{
330                      count++;
331                  \}
332                  \textcolor{keywordflow}{else}
333                     imgOut.pixel(target\_point.x, target\_point.y)=color;
334              \}
335          \}
336     \}
337 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!from3\+Dto2D@{from3\+Dto2D}}
\index{from3\+Dto2D@{from3\+Dto2D}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{from3\+Dto2\+D(const yarp\+::sig\+::\+Vector \&point3\+D)}{from3Dto2D(const yarp::sig::Vector &point3D)}}]{\setlength{\rightskip}{0pt plus 5cm}Vector Grasp\+Visualization\+::from3\+Dto2D (
\begin{DoxyParamCaption}
\item[{const yarp\+::sig\+::\+Vector \&}]{point3D}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a7217275a38ec798541bd68a84618bda6}


Convert 3D point to 3D point. 


\begin{DoxyParams}{Parameters}
{\em point3D} & is the 3D point to be converted \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a 2D vector representing the pixel 
\end{DoxyReturn}


Definition at line 340 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
341 \{
342     Vector point2D(3,0.0);
343     Vector point\_aux(4,1.0);
344     point\_aux.setSubvector(0,point3D);
345     point2D=K*H*point\_aux;
346     \textcolor{keywordflow}{return} point2D.subVector(0,1)/point2D[2];
347 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!get\+Par@{get\+Par}}
\index{get\+Par@{get\+Par}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{get\+Par()}{getPar()}}]{\setlength{\rightskip}{0pt plus 5cm}Property Grasp\+Visualization\+::get\+Par (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a9071090277d53e90c6392b7e879e0247}


Set parameters used for visualization. 

\begin{DoxyReturn}{Returns}
a Property with the options set for visualization 
\end{DoxyReturn}


Definition at line 560 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
561 \{
562     LockGuard lg(mutex);
563 
564     Property advOptions;
565     \textcolor{keywordflow}{if} (show_hand)
566         advOptions.put(\textcolor{stringliteral}{"show\_hand"},\textcolor{stringliteral}{"on"});
567     \textcolor{keywordflow}{else}
568         advOptions.put(\textcolor{stringliteral}{"show\_hand"},\textcolor{stringliteral}{"off"});
569     \textcolor{keywordflow}{if} (look_object)
570         advOptions.put(\textcolor{stringliteral}{"look\_object"},\textcolor{stringliteral}{"on"});
571     \textcolor{keywordflow}{else}
572         advOptions.put(\textcolor{stringliteral}{"look\_object"},\textcolor{stringliteral}{"off"});
573     \textcolor{keywordflow}{if} (show_only_pose)
574         advOptions.put(\textcolor{stringliteral}{"show\_only\_pose"},\textcolor{stringliteral}{"on"});
575     \textcolor{keywordflow}{else}
576         advOptions.put(\textcolor{stringliteral}{"show\_only\_pose"},\textcolor{stringliteral}{"off"});
577 
578     \textcolor{keywordflow}{return} advOptions;
579 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!get\+Poses@{get\+Poses}}
\index{get\+Poses@{get\+Poses}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{get\+Poses(const yarp\+::os\+::\+Property \&poses)}{getPoses(const yarp::os::Property &poses)}}]{\setlength{\rightskip}{0pt plus 5cm}void Grasp\+Visualization\+::get\+Poses (
\begin{DoxyParamCaption}
\item[{const yarp\+::os\+::\+Property \&}]{poses}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a11fdc62f11352941ce39bf0444060290}


Acquire poses from other threads. 


\begin{DoxyParams}{Parameters}
{\em poses} & contains the poses to be reached \\
\hline
\end{DoxyParams}


Definition at line 429 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
430 \{
431     LockGuard lg(mutex);
432     Vector tmp(6,0.0);
433     trajectory\_right.clear();
434     trajectory\_left.clear();
435 
436     Bottle &pose2=poses.findGroup(\textcolor{stringliteral}{"trajectory\_right"});
437 
438     \textcolor{keywordflow}{if} (!pose2.isNull())
439     \{
440         Bottle *p=pose2.get(1).asList();
441         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<p->size(); i++)
442         \{
443             Bottle *p1=p->get(i).asList();
444 
445 
446             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j=0; j<p1->size(); j++)
447             \{
448                 tmp[j]=p1->get(j).asDouble();
449             \}
450 
451             trajectory\_right.push\_back(tmp);
452         \}
453     \}
454 
455     Bottle &pose3=poses.findGroup(\textcolor{stringliteral}{"trajectory\_left"});
456 
457     \textcolor{keywordflow}{if} (!pose3.isNull())
458     \{
459         Bottle *p=pose3.get(1).asList();
460         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<p->size(); i++)
461         \{
462             Bottle *p1=p->get(i).asList();
463 
464 
465             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j=0; j<p1->size(); j++)
466             \{
467                 tmp[j]=p1->get(j).asDouble();
468             \}
469             trajectory\_left.push\_back(tmp);
470         \}
471     \}
472 
473     Bottle &pose=poses.findGroup(\textcolor{stringliteral}{"solution\_right"});
474     \textcolor{keywordflow}{if} (!pose.isNull())
475     \{
476         Bottle *p=pose.get(1).asList();
477 
478         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<p->size(); i++)
479             solR[i]=p->get(i).asDouble();
480     \}
481 
482     Bottle &pose1=poses.findGroup(\textcolor{stringliteral}{"solution\_left"});
483     \textcolor{keywordflow}{if} (!pose1.isNull())
484     \{
485         Bottle *p=pose1.get(1).asList();
486 
487         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<p->size(); i++)
488             solL[i]=p->get(i).asDouble();
489     \}
490 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!get\+Time@{get\+Time}}
\index{get\+Time@{get\+Time}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{get\+Time()}{getTime()}}]{\setlength{\rightskip}{0pt plus 5cm}double Grasp\+Visualization\+::get\+Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_ac9d26a90c1f1b6121ebbb0521053a80f}


Get time required for showing the superquadrics and poses. 

\begin{DoxyReturn}{Returns}
the thread period 
\end{DoxyReturn}


Definition at line 493 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
494 \{
495     LockGuard lg(mutex);
496     \textcolor{keywordflow}{return} t_vis;
497 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!set\+Par@{set\+Par}}
\index{set\+Par@{set\+Par}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{set\+Par(const yarp\+::os\+::\+Property \&new\+Options, bool first\+\_\+time)}{setPar(const yarp::os::Property &newOptions, bool first_time)}}]{\setlength{\rightskip}{0pt plus 5cm}void Grasp\+Visualization\+::set\+Par (
\begin{DoxyParamCaption}
\item[{const yarp\+::os\+::\+Property \&}]{new\+Options, }
\item[{bool}]{first\+\_\+time}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a68062fbac492b9277576f4ee871bdb41}


Set parameters for visualization. 


\begin{DoxyParams}{Parameters}
{\em new\+Options} & are the options to be set \\
\hline
{\em first\+\_\+time} & takes into account if the options have been set once \\
\hline
\end{DoxyParams}


Definition at line 500 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
501 \{
502     LockGuard lg(mutex);
503 
504     \textcolor{keywordtype}{string} show\_h=newOptions.find(\textcolor{stringliteral}{"show\_hand"}).asString();
505 
506     \textcolor{keywordflow}{if} (newOptions.find(\textcolor{stringliteral}{"show\_hand"}).isNull() && (first\_time==\textcolor{keyword}{true}))
507     \{
508         show_hand=\textcolor{keyword}{false};
509     \}
510     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!newOptions.find(\textcolor{stringliteral}{"show\_hand"}).isNull())
511     \{
512         \textcolor{keywordflow}{if} ((show\_h==\textcolor{stringliteral}{"on"}) || (show\_h==\textcolor{stringliteral}{"off"}))
513         \{
514             show_hand=(show\_h==\textcolor{stringliteral}{"on"});
515         \}
516         \textcolor{keywordflow}{else}
517         \{
518             show_hand=\textcolor{keyword}{false};
519         \}
520     \}
521 
522     \textcolor{keywordtype}{string} l\_o=newOptions.find(\textcolor{stringliteral}{"look\_object"}).asString();
523 
524     \textcolor{keywordflow}{if} (newOptions.find(\textcolor{stringliteral}{"look\_object"}).isNull() && (first\_time==\textcolor{keyword}{true}))
525     \{
526         look_object=\textcolor{keyword}{false};
527     \}
528     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!newOptions.find(\textcolor{stringliteral}{"look\_object"}).isNull())
529     \{
530         \textcolor{keywordflow}{if} ((l\_o==\textcolor{stringliteral}{"on"}) || (l\_o==\textcolor{stringliteral}{"off"}))
531         \{
532             look_object=(l\_o==\textcolor{stringliteral}{"on"});
533         \}
534         \textcolor{keywordflow}{else}
535         \{
536             look_object=\textcolor{keyword}{false};
537         \}
538     \}
539 
540     \textcolor{keywordtype}{string} show\_pose=newOptions.find(\textcolor{stringliteral}{"show\_only\_pose"}).asString();
541 
542     \textcolor{keywordflow}{if} (newOptions.find(\textcolor{stringliteral}{"show\_only\_pose"}).isNull() && (first\_time==\textcolor{keyword}{true}))
543     \{
544         show_only_pose=\textcolor{keyword}{false};
545     \}
546     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!newOptions.find(\textcolor{stringliteral}{"show\_only\_pose"}).isNull())
547     \{
548         \textcolor{keywordflow}{if} ((show\_pose==\textcolor{stringliteral}{"on"}) || (show\_pose==\textcolor{stringliteral}{"off"}))
549         \{
550             show_only_pose=(show\_pose==\textcolor{stringliteral}{"on"});
551         \}
552         \textcolor{keywordflow}{else}
553         \{
554             show_only_pose=\textcolor{keyword}{false};
555         \}
556     \}
557 \}
\end{DoxyCode}
\index{Grasp\+Visualization@{Grasp\+Visualization}!show\+Trajectory@{show\+Trajectory}}
\index{show\+Trajectory@{show\+Trajectory}!Grasp\+Visualization@{Grasp\+Visualization}}
\subsubsection[{\texorpdfstring{show\+Trajectory(const std\+::string \&hand)}{showTrajectory(const std::string &hand)}}]{\setlength{\rightskip}{0pt plus 5cm}bool Grasp\+Visualization\+::show\+Trajectory (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{hand}
\end{DoxyParamCaption}
)}\label{classGraspVisualization_a3ada3605a942fb51696e9747fed52a72}


Show the computed trajectory. 


\begin{DoxyParams}{Parameters}
{\em hand} & is the name of the hand used \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true 
\end{DoxyReturn}


Definition at line 39 of file grasp\+Visualization.\+cpp.


\begin{DoxyCode}
40 \{
41     \textcolor{keywordtype}{int} count=0;
42     ImageOf<PixelRgb> *imgIn=portImgIn.read(\textcolor{keyword}{false});
43     \textcolor{keywordflow}{if} (imgIn==NULL)
44         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
45 
46     ImageOf<PixelRgb> &imgOut=portImgOut.prepare();
47     imgOut=*imgIn;
48 
49     cv::Mat imgInMat=cv::cvarrToMat((IplImage*)imgIn->getIplImage());
50     cv::Mat imgOutMat=cv::cvarrToMat((IplImage*)imgOut.getIplImage());
51     imgInMat.copyTo(imgOutMat);
52 
53     PixelRgb color(255,255,0);
54 
55     Vector waypoint(6,0.0);
56     Vector waypoint2D(2,0.0);
57 
58     Vector x(3,0.0);
59     Vector y(3,0.0);
60     Vector z(3,0.0);
61     \textcolor{keywordtype}{double} length=0.04;
62     Vector dir\_x(3,0.0);
63     Vector dir\_y(3,0.0);
64     Vector dir\_z(3,0.0);
65     Vector x2D(2,0.0);
66     Vector y2D(2,0.0);
67     Vector z2D(2,0.0);  
68 
69     addSuperq(\textcolor{keywordtype}{object},imgOut,255);
70 
71      \textcolor{comment}{//if (show\_hand)}
72     \textcolor{comment}{//yDebug()<<"Hand in pose R"<<hand\_in\_poseR.toString();}
73     \textcolor{comment}{//        addSuperq(hand\_in\_poseR,imgOut,0);}
74 
75     \textcolor{keywordflow}{if} (trajectory\_right.size()>0 || trajectory\_left.size()>0)
76     \{
77         trajectory.clear();
78 
79         \textcolor{keywordflow}{if} (hand\_str==\textcolor{stringliteral}{"right"})
80         \{
81             hand\_in\_poseR.setSubvector(0,hand);
82             hand\_in\_poseR.setSubvector(5,solR);
83 
84             yDebug()<<\textcolor{stringliteral}{"Hand in pose R"}<<hand\_in\_poseR.toString();
85             \textcolor{keywordflow}{if} (show_hand)
86                 addSuperq(hand\_in\_poseR,imgOut,0);
87 
88             \textcolor{keywordflow}{if} (show_only_pose)
89             \{
90                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_right.size(); i++)
91                     trajectory.push\_back(trajectory\_right[trajectory\_right.size()-1]);
92             \}
93             \textcolor{keywordflow}{else}
94             \{
95                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_right.size(); i++)
96                     trajectory.push\_back(trajectory\_right[i]);
97             \}
98         \}
99         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (hand\_str==\textcolor{stringliteral}{"left"})
100         \{
101             hand\_in\_poseL.setSubvector(0,hand1);
102             hand\_in\_poseL.setSubvector(5,solL);
103 
104             \textcolor{keywordflow}{if} (show_hand)               
105                 addSuperq(hand\_in\_poseL,imgOut,0);
106 
107             \textcolor{keywordflow}{if} (show_only_pose)
108             \{
109                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_left.size(); i++)
110                     trajectory.push\_back(trajectory\_left[trajectory\_left.size()-1]);
111             \}
112             \textcolor{keywordflow}{else}
113             \{
114                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_left.size(); i++)
115                     trajectory.push\_back(trajectory\_left[i]);
116             \}
117         \}
118         \textcolor{keywordflow}{else}
119         \{
120             hand\_in\_poseR.setSubvector(0,hand);
121             hand\_in\_poseR.setSubvector(5,solR);
122             \textcolor{keywordflow}{if} (show_hand)
123                 addSuperq(hand\_in\_poseR,imgOut,0);
124 
125             \textcolor{keywordflow}{if} (show_only_pose)
126             \{
127                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_right.size(); i++)
128                     trajectory.push\_back(trajectory\_right[trajectory\_right.size()-1]);
129             \}
130             \textcolor{keywordflow}{else}
131             \{
132                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_right.size(); i++)
133                     trajectory.push\_back(trajectory\_right[i]);
134             \}
135 
136             hand\_in\_poseL.setSubvector(0,hand1);
137             hand\_in\_poseL.setSubvector(5,solL);
138             \textcolor{keywordflow}{if} (show_hand)
139                 addSuperq(hand\_in\_poseL,imgOut,0);
140 
141             \textcolor{keywordflow}{if} (show_only_pose)
142             \{
143                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_left.size(); i++)
144                     trajectory.push\_back(trajectory\_left[trajectory\_left.size()-1]);
145             \}
146             \textcolor{keywordflow}{else}
147             \{
148                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory\_left.size(); i++)
149                     trajectory.push\_back(trajectory\_left[i]);
150             \}
151         \}
152 
153         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i=0; i<trajectory.size(); i++)
154         \{
155             waypoint=trajectory[i];
156 
157             \textcolor{keywordflow}{if} (eye==\textcolor{stringliteral}{"left"})
158                 igaze->get2DPixel(0,waypoint.subVector(0,2),waypoint2D);
159             \textcolor{keywordflow}{else}
160                 igaze->get2DPixel(1,waypoint.subVector(0,2),waypoint2D);
161 
162             Matrix H=euler2dcm(waypoint.subVector(3,5));
163 
164             dir\_x=H.subcol(0,0,3);
165             dir\_y=H.subcol(0,1,3);
166             dir\_z=H.subcol(0,2,3);
167 
168             x[0]=waypoint[0]+length*dir\_x[0]; x[1]=waypoint[1]+length*dir\_x[1]; x[2]=waypoint[2]+length*
      dir\_x[2];
169             y[0]=waypoint[0]+length*dir\_y[0]; y[1]=waypoint[1]+length*dir\_y[1]; y[2]=waypoint[2]+length*
      dir\_y[2];
170             z[0]=waypoint[0]+length*dir\_z[0]; z[1]=waypoint[1]+length*dir\_z[1]; z[2]=waypoint[2]+length*
      dir\_z[2];
171 
172             \textcolor{keywordflow}{if} (eye==\textcolor{stringliteral}{"left"})
173             \{
174                 igaze->get2DPixel(0,x,x2D);
175                 igaze->get2DPixel(0,y,y2D);
176                 igaze->get2DPixel(0,z,z2D);
177             \}
178             \textcolor{keywordflow}{else}
179             \{
180                 igaze->get2DPixel(1,x,x2D);
181                 igaze->get2DPixel(1,y,y2D);
182                 igaze->get2DPixel(1,z,z2D);
183             \}
184 
185             cv::Point  target\_point((\textcolor{keywordtype}{int})waypoint2D[0],(\textcolor{keywordtype}{int})waypoint2D[1]);
186             cv::Point  target\_pointx((\textcolor{keywordtype}{int})x2D[0],(\textcolor{keywordtype}{int})x2D[1]);
187             cv::Point  target\_pointy((\textcolor{keywordtype}{int})y2D[0],(\textcolor{keywordtype}{int})y2D[1]);
188             cv::Point  target\_pointz((\textcolor{keywordtype}{int})z2D[0],(\textcolor{keywordtype}{int})z2D[1]);
189 
190             \textcolor{keywordflow}{if} ((target\_point.x<0) || (target\_point.y<0) || (target\_point.x>=320) || (target\_point.y>=240))
191             \{
192                 count++;
193             \}
194             \textcolor{keywordflow}{else}
195                 imgOut.pixel(target\_point.x, target\_point.y)= color;
196 
197             \textcolor{keywordflow}{if} ((target\_pointx.x<0) || (target\_pointx.y<0) || (target\_pointx.x>=320) || (target\_pointx.y>=2
      40))
198             \{
199                 count++;
200             \}
201             \textcolor{keywordflow}{else}
202                 cv::line(imgOutMat,target\_point,target\_pointx,cv::Scalar(255,0,0));
203 
204             \textcolor{keywordflow}{if} ((target\_pointy.x<0) || (target\_pointy.y<0) || (target\_pointy.x>=320) || (target\_pointy.y>=2
      40))
205             \{
206                 count++;
207             \}
208             \textcolor{keywordflow}{else}
209                 cv::line(imgOutMat,target\_point,target\_pointy,cv::Scalar(0,255,0));
210 
211             \textcolor{keywordflow}{if} ((target\_pointz.x<0) || (target\_pointz.y<0) || (target\_pointz.x>=320) || (target\_pointz.y>=2
      40))
212             \{
213                 count++;
214             \}
215             \textcolor{keywordflow}{else}
216                 cv::line(imgOutMat,target\_point,target\_pointz,cv::Scalar(0,0,255));            
217         \}
218 
219         \textcolor{keywordflow}{if} (hand\_str==\textcolor{stringliteral}{"both"})
220         \{
221             stringstream q\_r, q\_l;
222             q\_r<<round( quality\_right * 100.0 ) / 100.0;
223             q\_l<<round( quality\_left * 100.0 ) / 100.0;
224 
225             stringstream right, left;
226             right<<\textcolor{stringliteral}{"cost right"};
227             left<<\textcolor{stringliteral}{"cost left"};
228 
229             \textcolor{keywordtype}{int} thickness=2.0;
230             \textcolor{keywordtype}{int} font=cv::FONT\_HERSHEY\_SIMPLEX;
231             \textcolor{keywordtype}{double} fontScale=0.5;
232 
233             cv::Scalar red(230,0,0);
234             cv::Scalar blue(0,240,0);
235 
236             cv::Scalar iol\_green(22,88,248);
237             cv::Scalar iol\_red(244,16, 46);
238 
239             \textcolor{keywordflow}{if} ((quality\_right<quality\_left) && (quality\_right!=0.0) && (quality\_left!=0.0))
240             \{
241                 cv::putText(imgOutMat, q\_r.str(), cv::Point(200,85), font, fontScale, iol\_green, thickness)
      ;
242                 cv::putText(imgOutMat, q\_l.str(), cv::Point(50,85), font, fontScale, iol\_red, thickness);
243                 cv::putText(imgOutMat, right.str(), cv::Point(200,55), font, fontScale, iol\_green, 
      thickness);
244                 cv::putText(imgOutMat, left.str(), cv::Point(50,55), font, fontScale, iol\_red, thickness);
245             \}
246             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((quality\_right>quality\_left) && (quality\_right!=0.0) && (quality\_left!=0.0))
247             \{
248                 cv::putText(imgOutMat, q\_r.str(), cv::Point(200,85), font, fontScale, iol\_red, thickness);
249                 cv::putText(imgOutMat, q\_l.str(), cv::Point(50,85), font, fontScale, iol\_green, thickness);
250                 cv::putText(imgOutMat, right.str(), cv::Point(200,55), font, fontScale, iol\_red, thickness)
      ;
251                 cv::putText(imgOutMat, left.str(), cv::Point(50,55), font, fontScale, iol\_green, thickness)
      ;
252             \}
253         \}
254             
255     \}
256 
257     portImgOut.write();
258 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/gvezzani/\+Desktop/\+Ph\+D/\+Anno\+\_\+1/super\+Quadratiche/superquadric-\/grasping/include/grasp\+Visualization.\+h\item 
/home/gvezzani/\+Desktop/\+Ph\+D/\+Anno\+\_\+1/super\+Quadratiche/superquadric-\/grasping/src/grasp\+Visualization.\+cpp\end{DoxyCompactItemize}
